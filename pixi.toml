[workspace]
name = "classifier-training"
version = "0.1.0"
description = "Basketball jersey number classifier training"
authors = ["Enrique G. Ortiz <ortizeg@gmail.com>"]
channels = ["conda-forge"]
platforms = ["osx-arm64", "linux-64"]

[system-requirements]
cuda = "12.1"

[tasks]
test = "pytest"
test-cov = "pytest --cov=src --cov-report=term --cov-report=xml -v"
lint = "ruff check ."
format = "ruff format ."
format-check = "ruff format --check ."
typecheck = "mypy src/"
task_manager = "python -m classifier_training.train"
train-local = "python -m classifier_training.train --config-name=train_jersey_ocr_resnet18_local"
precommit = "pre-commit run --all-files"
build = { cmd = "bash scripts/cloud-build.sh" }
build-local = { cmd = "bash scripts/build-docker.sh --local" }
generate-synthetic = "python scripts/generate_synthetic.py --config configs/synthetic_default.yaml"

[dependencies]
python = "3.11.*"
lightning = "*"
loguru = "*"
numpy = "<2.0.0"
pydantic = ">=2.0"
pytorch = "*"
torchvision = "*"
hydra-core = "*"
torchmetrics = "*"
pillow = "*"
rich = "*"
matplotlib = "*"
onnxscript = ">=0.5.6,<0.6"
pandas = "*"
psutil = ">=7.2.2,<8"
tqdm = ">=4.67.3,<5"
transformers = ">=5.2.0,<6"
num2words = ">=0.5.14,<0.6"

[feature.dev.dependencies]
pytest = "*"
pytest-cov = "*"
ruff = "*"
mypy = "*"
pre-commit = "*"

[environments]
default = ["dev"]
prod = []

[pypi-dependencies]
classifier-training = { path = ".", editable = true }
onnxruntime = ">=1.23.2, <2"
wandb = ">=0.19,<1.0"
